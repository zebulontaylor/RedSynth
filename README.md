# RedSynth

RedSynth is a powerful tool for synthesizing Minecraft Redstone circuits from hardware description languages (like Verilog). It takes a synthesized netlist (in Yosys JSON format), places the components in 3D space, routes the connections using redstone rules, and generates a visualizable model of the final circuit.

## Features

- **Netlist Parsing**: Imports digital logic designs from Yosys JSON netlists.
- **3D Placement**: Uses force-directed graph layout (spring layout) with legalization to optimize component placement in 3D space.
- **Intelligent Routing**: Implements A* search with rip-up and reroute capabilities to connect components, handling 3D obstacles and preventing crosstalk.
- **Redstone Synthesis**: Converts abstract connections into valid Minecraft redstone structures, including:
    - Automatic repeater insertion for signal strength and delay management.
    - Vertical signal transmission (glass towers/slabs).
    - Crosstalk prevention logic.
- **Visualization**:
    - **Interactive 3D**: Web-based 3D visualization using Plotly to explore the placed and routed circuit.
    - **Static Plots**: 2D and 3D projections using Matplotlib for quick verification.

## Installation

RedSynth requires Python 3 and the following dependencies:

```bash
pip install networkx numpy matplotlib plotly scipy
```

## Usage

To synthesize a circuit from a netlist:

```bash
python3 redsynth.py netlist.json
```

### Arguments

- `netlist`: Path to the input Yosys JSON netlist (default: `netlist.json`).
- `--timeout`: Optimization timeout in seconds (default: 60.0).
- `--load`: Load a previously saved routed model JSON instead of synthesizing from scratch.
- `--output`, `-o`: Output file for the saved model (default: `routed_model.json`).

### Example

```bash
# Synthesize a design with a 2-minute timeout
python3 redsynth.py my_design.json --timeout 120

# Load and visualize an existing model
python3 redsynth.py --load routed_model.json
```

## Input Format

RedSynth expects a JSON netlist generated by [Yosys](https://yosyshq.net/yosys/). You can generate this using the `.ys` scripts provided.

```bash
# Small demo; creates netlist_simple.json
yosys synth_simple.ys

# Full demo; creates netlist.json
yosys synth.ys
```

## Tests

The `tests` directory contains some tests, however they may be outdated - YMMV. The one that is frequently used and should work is `visualize_permutations.py`, which creates a test grid of many different redstone moves and visualizes them.

```bash
python3 tests/visualize_permutations.py
```

## Output

The tool generates several outputs:
- `routed_model.json`: A JSON representation of the final routed circuit, including component positions and wire paths.
- `netlist_graph.html`: An interactive 3D visualization of the circuit.
- `netlist_graph.png`: A static 3D plot.
- `netlist_projection_2d.png`: A top-down 2D projection of the routing.
